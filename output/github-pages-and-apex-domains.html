<!doctype html>
<meta charset="utf-8">
<title>GitHub Pages is slow with root domains - InstantClick</title>
<meta name="viewport" content="width=1024">
<style>body{font:18px/1.4 Iowan Old Style, Palatino, Calisto MT, Bitstream Charter, Georgia, serif;background:#f0f4fb;margin:0;overflow-y:scroll}a{color:#d22}a:visited{color:#911}::selection{background:rgba(255, 0, 0, .1)}::-moz-selection{background:rgba(255, 0, 0, .1)}#instantclick-bar{background:#d22}#header{max-width:600px;margin:15px auto 0}#header h1{margin:0;background:url('logo.png') left center no-repeat;background-size:contain;width:220px;height:48px}#header h1 a{display:block;text-indent:-999em;height:48px}#header ul{margin:10px 0 0;padding:0 5px;background:#556;font-family:Verdana, sans-serif;font-size:14px;border-radius:3px;list-style:none}#header li{display:inline-block}#header li a{color:#eee;text-decoration:none;padding:5px 10px;display:block}#header li a:hover{color:white;background-color:#800}#header li.on a{background:#b22;color:white}.twitter, .github{float:right}.twitter a{background:url('twitter.svg') center no-repeat}.github a{background:url('github.png') center no-repeat}.twitter a, .github a{text-indent:-999em;width:20px;background-size:20px}.container{background:rgba(255,255,255,.8);padding:1em;margin:1.5em auto;border-radius:15px;width:600px}h2{color:#d22;margin-bottom:.56em}h2:first-child{margin-top:0}h3{color:#b11;margin:1.33em 0 .75em}.gist+h3{margin-top:1.66em}h4{color:#900;margin:1em 0 .66em}.gist+h4{margin-top:1.25em}h2+p, h3+p, h4+p{margin-top:0}.intro{margin-top:0;font-size:1.5em}.intro span{color:#d22;font-weight:bold}p+ul, p+ol{margin-top:-.75em}hr{border:none;text-align:center;font-size:12px;margin:18px 0}hr:after{color:rgba(187,17,17,.8);content:'••••';letter-spacing:30px}.gist+hr{margin-top:22px}.warning{background:rgba(255,165,0,.2);padding:.25em .5em;border-radius:3px;border:1px solid rgba(255,165,0,.5);font-size:17px}#downloads td{padding:0 20px 0 0}.support{font-size:.85em;width:100%;text-align:center;border-spacing:0;border:solid #aab;border-width:1px 0 0 1px}.support td, .support th{border:solid #aab;border-width:0 1px 1px 0}.btn{display:inline-block;color:white !important;background:#d22;border-radius:6px;padding:7px 10px 6px;text-decoration:none;text-align:center;font:16px/1 Helvetica Neue, sans-serif;border:1px solid #d22;box-shadow:inset 0 1px 1px rgba(255,255,255,.15), 0 1px 1px rgba(0,0,0,.5)}.btn:hover{background:#c11;border-color:#c11;box-shadow:inset 0 1px 1px rgba(255,255,255,.2), 0 1px 1px rgba(0,0,0,.6)}.btn:active{background:#c11;position:relative;top:1px;box-shadow:inset 0 2px 5px rgba(0,0,0,.1)}.btn-big{border-radius:7px;font-size:18px;padding:10px 17px 9px}.btn small{font-size:.72em}code{background:#f8f8ff;font-size:14px;font-family:Consolas, Menlo, DejaVu Sans Mono, monospace;white-space:pre;border:1px solid #ccc;border-bottom-color:#bbb;display:inline-block;border-radius:2px;padding:0 3px}sup{vertical-align:initial;position:relative;top:-.42em}sup a{text-decoration:none;margin:-.5em -.3em;padding:.5em}#footnotes li:target{background:#ffb;border-radius:1px}#footnotes li{font-size:16px;padding:3px}.noteBack{font-size:18px}#click-test{width:100%;text-align:center;border:solid #aab;border-width:1px 0 0 1px;border-collapse:collapse}#click-test td, #click-test th{border:solid #aab;border-width:0px 1px 1px 0px;width:40%}#link1:active{background:none}#link2{margin:30px;font-size:20px;padding:14px 22px 13px;background:#d22;border:1px solid #d22;box-shadow:inset 0 1px 1px rgba(255,255,255,.15), 0 1px 1px rgba(0,0,0,.5);top:0}#click-test .results p{text-align:left;margin-left:10px}#footer{margin-top:2.5em;border-top:1px solid #ccd;font-size:.83em;padding:.83em 0;text-align:center;color:#222;background:rgba(0,0,0,.1);background:-webkit-linear-gradient(rgba(0,0,0,.05), rgba(0,0,0,0));background:linear-gradient(rgba(0,0,0,.05), rgba(0,0,0,0))}.gist{color:#000; font-size:14px}.gist pre{font:inherit;line-height:inherit;white-space:pre}.gist .gist-file{border:1px solid #ddd;border-bottom:1px solid #ccc;border-radius:3px;font-family:Consolas, Menlo, DejaVu Sans Mono, monospace;margin-bottom:1em}.gist .gist-file .gist-data{overflow:auto;word-wrap:normal;background-color:#f8f8ff;font-size:100%}.gist .gist-file .gist-data .line-data{padding:.5em !important}.gist .gist-file .gist-data .line-pre{background:transparent !important;border:none !important;margin:0 !important;padding:0 !important}.gist .gist-file .gist-data .line-numbers{background-color:#ececec;color:#aaa;border-right:1px solid #ddd;text-align:right;padding:.5em}.gist .gist-file .gist-data .line-numbers .line-number{clear:right;display:block}.gist-syntax{background:#ffffff}.c{color:#999988;font-style:italic}.err{color:#a61717;background-color:#e3d2d2}.k{color:#000000;font-weight:bold}.o{color:#000000;font-weight:bold}.cm{color:#999988;font-style:italic}.cp{color:#999999;font-weight:bold}.c1{color:#999988;font-style:italic}.cs{color:#999999;font-weight:bold;font-style:italic}.gd{color:#000000;background-color:#fdd}.gd .x{color:#000000;background-color:#faa}.ge{color:#000000;font-style:italic}.gr{color:#a00}.gh{color:#999}.gi{color:#000000;background-color:#dfd}.gi .x{color:#000000;background-color:#afa}.go{color:#888}.gp{color:#555}.gs{font-weight:bold}.gu{color:#aaa}.gt{color:#a00}.kc{color:#000000;font-weight:bold}.kd{color:#000000;font-weight:bold}.kp{color:#000000;font-weight:bold}.kr{color:#000000;font-weight:bold}.kt{color:#445588;font-weight:bold}.m{color:#099}.s{color:#d14}.na{color:teal}.nb{color:#0086b3}.nc{color:#445588;font-weight:bold}.no{color:teal}.ni{color:purple}.ne{color:#990000;font-weight:bold}.nf{color:#990000;font-weight:bold}.nn{color:#555}.nt{color:navy}.nv{color:teal}.ow{color:#000000;font-weight:bold}.w{color:#bbb}.mf{color:#099}.mh{color:#099}.mi{color:#099}.mo{color:#099}.sb{color:#d14}.sc{color:#d14}.sd{color:#d14}.s2{color:#d14}.se{color:#d14}.sh{color:#d14}.si{color:#d14}.sx{color:#d14}.sr{color:#009926}.s1{color:#d14}.ss{color:#990073}.bp{color:#999}.vc{color:teal}.vg{color:teal}.vi{color:teal}.il{color:#099}</style>
<meta name="description" content="GitHub Pages with a custom root domain is terribly slow. It will make 35% of your visitors go away.">
<link rel="canonical" href="http://instantclick.io/github-pages-and-apex-domains">

<header id="header">
  <h1><a href=".">InstantClick</a></h1>
  <ul>
    <li class="github"><a href="https://github.com/dieulot/instantclick" title="GitHub">Github</a>
    <li class="twitter"><a href="https://twitter.com/instantclickjs" title="Twitter">Twitter</a>
    <li><a href=".">Home</a>
    <li><a href="download">Download</a>
    <li><a href="click-test">Click test</a>
    <li><a href="changelog">Changelog</a>
  </ul>
</header>
<article class="container">
<h2>GitHub Pages with a custom root domain loses you 35% of your visitors</h2>

<p>If you have a website on GitHub Pages that sits on a root domain (a domain that isn’t a subdomain), you’re in trouble.

<p>Have you ever noticed how your site loads slowly sometimes? It’s not your connection.

<h3>Some scary stats</h3>

<p>GitHub Pages with a custom domain is <b><em>unbelievably slow</em></b>.

<p><img src="scary-analytics.png" title="Average page load time: 3.49 seconds">

<p>Visitors to this site’s index page have an average page load time of 3.5 seconds. 70% of those are here for the first time. 3.5 ÷ 70% = 5. So first time visitors have an average page load time of <b>5 seconds</b>. <sup id="note-analytics-back"><a href="#note-analytics">1</a></sup>

<p>This website is now off of GitHub Pages and loads in 700 milliseconds on a first visit, gaining over 4 seconds.

<p>What do you lose when you add 4 seconds of delay on a first time visit?

<p>
<a href="pages_per_visit_falloff_by_landing_page_speed.jpg" data-no-instant><img src="pages_per_visit_falloff_by_landing_page_speed.jpg" title="Pages per visit fall-off by landing page speed"  style="width: 250px;"></a>
<a href="change_in_bounce_rate_by_landing_page_speed.jpg" data-no-instant><img src="change_in_bounce_rate_by_landing_page_speed.jpg" title="Change in bounce rate by landing page speed" style="width: 250px;"></a>
<small><a href="http://www.webperformancetoday.com/2010/07/01/the-best-graphs-of-velocity/" title="The 16 Best Graphs of Velocity 2010: A snapshot of the current web performance landscape">Source</a></small>

<p>Of the visitors that visit your GitHub Pages site for the first time, 35% more of them won’t bother to open another page. Your bounce rate is doubled.

<h3>Where does this problem come from?</h3>

<p>Anselm Hannemann has <a href="http://helloanselm.com/2014/github-pages-redirect-performance/" title="Analyzing the GitHub Pages Waterfall Chart">a good rundown of the problem</a>, including a note from GitHub support. When a domain has a DNS A record (pointing to GitHub Pages’ IP), GitHub’s DDoS mitigation technology has no alternative than to make a long redirect

<p>What I’ve noticed is that sometimes it’s not just a big long redirect but multiple 302 redirects. This behavior isn’t documented anywhere it seems.

<p><a href="302-spam.png" data-no-instant><img src="302-spam.png" style="width: 100%" title="Multiple 302 redirects"></a>

<p>5 seconds seems big. When I notice a slow GitHub Pages website the wait seems to be more around 3 seconds, and that’s what I usually see in Chrome’s Network panel. The thing is, InstantClick’s visitors are spread around the world, my guess is this is what tilt the balance. <sup id="note-cosmopolitan-back"><a href="#note-cosmopolitan">2</a></sup>



<h3>The solution</h3>

<p>The short solution is, instead of using <code>yourdomain.com</code>, use <code>www.yourdomain.com</code>. <sup id="note-cname-back"><a href="#note-cname">3</a></sup>

<p>If you want to keep your clean www-less domain, you’ll have to move off of GitHub Pages, and/or use CloudFlare who can have a <a href="http://blog.cloudflare.com/introducing-cname-flattening-rfc-compliant-cnames-at-a-domains-root">CNAME record on the root domain</a>. The latter has the advantage of making your website super-fast across the globe with its edge caching feature.

<p><em>Updates: 1. Thanks to Hacker News’s dknecht who <a href="https://news.ycombinator.com/item?id=7738362">pointed out</a> that CloudFlare can have a CNAME record on the root domain, which should solve GitHub Pages’ performance issues. 2. I previously recommended moving to Neocities, but <a href="https://news.ycombinator.com/item?id=7738781">they currently have similar problems</a>. :(</em>

<p>This website uses a Digital Ocean VPS <sup id="note-digitalocean-back"><a href="#note-digitalocean">4</a></sup> with CloudFlare.

<p>By the way, you should defitively <a href="/">check out InstantClick</a> if you care about web performance.

<h3>Footnotes</h3>

<ol id="footnotes">
  <li id="note-analytics">I couldn’t find a way to get this number from Google Analytics directly. The difference with subsequent page load times isn’t counted here, because with InstantClick (<a href="/">check it out</a>) subsequent page loads usually take zero second. <a href="#note-analytics-back" class="noteBack">↩</a>
  <li id="note-cosmopolitan">The 5 top-visiting countries are USA (22%), France (9%), Russia (7%), China (6%) and UK (6%). I’m personally located in France. <a href="#note-cosmopolitan-back" class="noteBack">↩</a>
  <li id="note-cname">Update: I previously recommended putting a CNAME from the root domain to the www domain here. But as <a href="https://news.ycombinator.com/item?id=7738424">pointed out</a> by pilif on Hacker News that’s not possible (unless you use CloudFlare). It’s what’s causing the issue with GitHub Pages in the first place actually, <em>duh</em>. <a href="#note-cname-back" class="noteBack">↩</a>
  <li id="note-digitalocean"><a href="https://www.digitalocean.com/?refcode=5fe3cf170a1f" title="Digital Ocean">They</a> offer a coupon code valid through May by the way, DODROPLET will give you $10 of credits. Also valid for existing customers. <a href="#note-digitalocean-back" class="noteBack">↩</a>
</ol></article>
<div id="footer">InstantClick is released under the <a href="license">MIT License</a>, © 2014 Alexandre Dieulot</div>
<script src="script-6.js" data-no-instant></script>
